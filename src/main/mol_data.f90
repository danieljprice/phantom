!--------------------------------------------------------------------------!
! The Phantom Smoothed Particle Hydrodynamics code, by Daniel Price et al. !
! Copyright (c) 2007-2025 The Authors (see AUTHORS)                        !
! See LICENCE file for usage and distribution conditions                   !
! http://phantomsph.github.io/                                             !
!--------------------------------------------------------------------------!
module mol_data
!
! Written by S. Glover, AMNH, 2004-2005, AIP, 2006, ITA, 2017
!  Adapted for use in Phantom by D. Price, MoCA, 2011
!
!  Data for molecular cooling rates (H2, CO)
!
!  1) H2 cooling function data: based on data made available by
!  J. Le Bourlot, G. Pineau des Forets and  D. R. Flower
!  (see Le Bourlot et al, 1999, MNRAS, 305, 802; and also
!  http://ccp7.dur.ac.uk/cooling_by_h2/).
!
!  The LTE rate is in units of erg s^-1 molecule^-1; the low density
!  rates, on the other hand, are written in terms of erg s^-1 cm^3.
!
!  Data in the tables is for log(T) = 2.0 -> 4.0, at intervals of 0.05 dex
!
!  2) CO cooling function data: based on the LVG tabulated rates given in
!  Neufeld & Kaufman (1993, ApJ, 418, 263) and Neufeld, Lepp & Melnick
!  (1995, ApJS, 100, 132). Extended from 10 K to 5 K by
!  Glover & Clark (2012, MNRAS, 421, 116)
!
!  Reverted back to only 10K by Davide Dionese.
!  Since we want to use this in AGB outflows, we are not interested 
!  in what happens at such low temperatures.
!
! :References: None
!
! :Owner: Simon Glover
!
! :Runtime parameters: None
!
! :Dependencies: None
!
 implicit none
 integer, parameter :: nh2data = 41
 real :: h2_lte(nh2data), h2_h_rate(nh2data), h2_h2_rate(nh2data), h2_temp(nh2data)
!
! Low density limit -- almost pure H2 -- H/H2 = 1e-8
!
 data h2_h2_rate /-27.604, -27.340, -27.082, -26.856, -26.639, &
                  -26.440, -26.254, -26.078, -25.915, -25.756, &
                  -25.610, -25.466, -25.330, -25.195, -25.065, &
                  -24.937, -24.812, -24.689, -24.569, -24.453, &
                  -24.338, -24.230, -24.124, -24.022, -23.923, &
                  -23.828, -23.735, -23.645, -23.559, -23.475, &
                  -23.395, -23.316, -23.243, -23.171, -23.103, &
                  -23.038, -22.976, -22.918, -22.861, -22.809, &
                  -22.758/
!
! Low density limit -- almost pure H -- H/H2 = 1e6
!
 data h2_h_rate /-28.151, -27.865, -27.593, -27.342, -27.107, &
                 -26.882, -26.669, -26.467, -26.272, -26.085, &
                 -25.905, -25.730, -25.561, -25.395, -25.235, &
                 -25.078, -24.923, -24.772, -24.624, -24.478, &
                 -24.334, -24.192, -24.050, -23.910, -23.772, &
                 -23.634, -23.497, -23.359, -23.222, -23.086, &
                 -22.952, -22.820, -22.691, -22.565, -22.446, &
                 -22.332, -22.225, -22.123, -22.029, -21.943, &
                 -21.943/
!
! LTE rate -- independent of H2/H ratio
!
 data h2_lte /-25.440, -25.107, -24.792, -24.503, -24.239, -23.995, &
              -23.766, -23.550, -23.341, -23.136, -22.933, -22.731, &
              -22.529, -22.330, -22.134, -21.940, -21.748, -21.555, &
              -21.350, -21.122, -20.863, -20.575, -20.282, -20.008, &
              -19.764, -19.552, -19.365, -19.201, -19.056, -18.927, &
              -18.813, -18.712, -18.624, -18.549, -18.484, -18.429, &
              -18.382, -18.341, -18.307, -18.278, -18.253/
!
!
! Opacity correction -- Sobolev approx., as in YOHA06
!
 integer, parameter :: nh2op = 101
 real :: h2_opac_temp(nh2op), h2_opac_column(nh2op), h2_opac(nh2op,nh2op)
!
! CO & H2O optically thick rotational cooling 
!
 integer, parameter :: nco_temp   = 11
 integer, parameter :: nco_column = 10
 integer, parameter :: nco_data   = 110

 integer, parameter :: nh2o_temp_low = 6
 integer, parameter :: nh2o_temp_high = 5
 integer, parameter :: nh2o_temp = nh2o_temp_low + nh2o_temp_high
 integer, parameter :: nh2o_column = 10
 integer, parameter :: nh2o_data_low = 60
 integer, parameter :: nh2o_data_high = 50
 integer, parameter :: nh2o_data= nh2o_data_low + nh2o_data_high

 integer, parameter :: nco_vib_temp = 6
 integer, parameter :: nco_vib_column = 8
 integer, parameter :: nco_vib_data = 48

 integer, parameter :: nh2o_vib_temp = 6
 integer, parameter :: nh2o_vib_column = 8
 integer, parameter :: nh2o_vib_data = 48

 real :: co_temp(nco_temp), co_column(nco_column), co_data_L0(nco_temp)
 real :: co_data_LTE(nco_data), co_data_n05(nco_data), co_data_alp(nco_data)

 real :: co_vib_temp(nco_vib_temp), co_vib_column(nco_vib_column), co_vib_LTE(nco_vib_data)
 real :: h2o_temp_low(nh2o_temp_low), h2o_temp_high(nh2o_temp_high), &
         h2o_temp(nh2o_temp), h2o_column(nh2o_column)

 real :: h2o_L0_low_ortho(nh2o_temp_low), h2o_LTE_low_ortho(nh2o_data_low), &
         h2o_n05_low_ortho(nh2o_data_low), h2o_alp_low_ortho(nh2o_data_low)

 real :: h2o_L0_low_para(nh2o_temp_low), h2o_LTE_low_para(nh2o_data_low), &
         h2o_n05_low_para(nh2o_data_low), h2o_alp_low_para(nh2o_data_low)

 real :: h2o_L0_high(nh2o_temp_high), h2o_LTE_high(nh2o_data_high), &
         h2o_n05_high(nh2o_data_high), h2o_alp_high(nh2o_data_high)

 real :: h2o_data_L0_ortho(nh2o_temp), h2o_data_LTE_ortho(nh2o_data),&
         h2o_data_n05_ortho(nh2o_data), h2o_data_alp_ortho(nh2o_data)

 real :: h2o_data_L0_para(nh2o_temp), h2o_data_LTE_para(nh2o_data), &
         h2o_data_n05_para(nh2o_data), h2o_data_alp_para(nh2o_data)

 real :: h2o_vib_temp(nh2o_vib_temp), h2o_vib_column(nh2o_vib_column), h2o_vib_LTE(nh2o_vib_data)

 data co_temp /10., 20., 30., 50., 80., 100., 300., 600., 1000., 1500., 2000./

 data co_column /14.5, 15.0, 15.5, 16.0, 16.5, 17.0, 17.5, 18.0, 18.5, 19.0/

 data co_data_L0 /24.96, 24.56, 24.36, 24.12, 23.88,23.88, &
                  23.40, 23.07, 22.81, 22.61, 22.47/

 data co_data_LTE / 21.15, 20.39, 19.97, 19.47, 19.02, &
                    18.81, 17.82, 17.23, 16.82, 16.52, 16.33, &
                    21.25, 20.45, 20.02, 19.50, 19.04, &
                    18.83, 17.83, 17.24, 16.82, 16.52, 16.33, &
                    21.45, 20.58, 20.12, 19.57, 19.09, &
                    18.87, 17.84, 17.24, 16.83, 16.52, 16.33, &
                    21.73, 20.81, 20.31, 19.71, 19.20, &
                    18.96, 17.88, 17.26, 16.84, 16.53, 16.33, &
                    22.08, 21.11, 20.58, 19.95, 19.39, &
                    19.14, 17.98, 17.32, 16.88, 16.56, 16.35, &
                    22.47, 21.46, 20.91, 20.25, 19.67, &
                    19.40, 18.15, 17.44, 16.96, 16.62, 16.40, &
                    22.89, 21.85, 21.28, 20.60, 19.99, &
                    19.71, 18.41, 17.65, 17.13, 16.76, 16.52, &
                    23.32, 22.25, 21.67, 20.97, 20.35, &
                    20.07, 18.72, 17.93, 17.38, 16.98, 16.72, &
                    23.76, 22.68, 22.08, 21.37, 20.74, &
                    20.45, 19.07, 18.26, 17.69, 17.27, 17.00, &
                    24.21, 23.11, 22.51, 21.78, 21.14, &
                    20.85, 19.45, 18.62, 18.03, 17.61, 17.33/

 data co_data_n05 / 3.31, 3.72, 3.96, 4.24, 4.39, &
                    4.42, 4.95, 5.24, 5.43, 5.57, 5.68, &
                    3.11, 3.59, 3.87, 4.17, 4.35, &
                    4.38, 4.93, 5.23, 5.42, 5.57, 5.68, &
                    2.80, 3.34, 3.64, 4.01, 4.23, &
                    4.24, 4.88, 5.20, 5.42, 5.56, 5.68, &
                    2.37, 2.95, 3.31, 3.73, 3.99, &
                    4.01, 4.75, 5.13, 5.36, 5.54, 5.65, &
                    1.90, 2.50, 2.87, 3.33, 3.61, &
                    3.64, 4.50, 4.95, 5.24, 5.44, 5.58, &
                    1.40, 2.02, 2.40, 2.86, 3.17, &
                    3.21, 4.12, 4.65, 5.00, 5.25, 5.41, &
                    0.90, 1.52, 1.90, 2.38, 2.69, &
                    2.72, 3.67, 4.25, 4.63, 4.92, 5.13, &
                    0.40, 1.02, 1.41, 1.89, 2.19, &
                    2.22, 3.20, 3.77, 4.18, 4.51, 4.73, &
                    -0.09, 0.52, 0.91, 1.39, 1.69, &
                    1.73, 2.69, 3.29, 3.70, 4.03, 4.26, &
                    -0.59, 0.03, 0.41, 0.88, 1.19, &
                    1.23, 2.20, 2.79, 3.20, 3.54, 3.78/

 data co_data_alp / 0.37, 0.41, 0.42, 0.41, 0.38, &
                    0.38, 0.38, 0.38, 0.37, 0.36, 0.35, &
                    0.38, 0.42, 0.44, 0.42, 0.39, &
                    0.37, 0.37, 0.37, 0.37, 0.36, 0.35, &
                    0.38, 0.43, 0.44, 0.43, 0.40, &
                    0.36, 0.36, 0.36, 0.36, 0.35, 0.34, &
                    0.36, 0.41, 0.43, 0.43, 0.40, &
                    0.36, 0.35, 0.35, 0.35, 0.34, 0.33, &
                    0.34, 0.37, 0.39, 0.39, 0.39, &
                    0.38, 0.35, 0.34, 0.34, 0.33, 0.32, &
                    0.31, 0.33, 0.35, 0.35, 0.35, &
                    0.41, 0.37, 0.35, 0.33, 0.32, 0.31, &
                    0.28, 0.31, 0.32, 0.32, 0.31, &
                    0.44, 0.40, 0.37, 0.35, 0.32, 0.31, &
                    0.26, 0.28, 0.29, 0.28, 0.28, &
                    0.47, 0.43, 0.40, 0.38, 0.35, 0.33, &
                    0.25, 0.26, 0.26, 0.26, 0.26, &
                    0.49, 0.46, 0.43, 0.41, 0.38, 0.36, &
                    0.23, 0.25, 0.25, 0.24, 0.25, &
                    0.51, 0.48, 0.46, 0.44, 0.41, 0.39/

!
! H2O rotational cooling
!
 data h2o_temp_low /10., 20., 30., 50., 80., 100./ 
 data h2o_temp_high /200., 400., 1000., 2000., 4000./

 data h2o_column /10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, &
                  18.0, 19.0/

 data h2o_L0_low_ortho /26.81, 25.88, 25.43, 24.96, 24.58, 24.41/
 data h2o_L0_low_para  /27.01, 25.73, 25.24, 24.75, 24.38, 24.22/
 data h2o_L0_high      /23.87, 23.42, 22.88, 22.50, 22.14/

 data h2o_LTE_low_ortho /17.94, 16.71, 16.08, 15.41, 14.85, 14.60, &
                         17.96, 16.72, 16.09, 15.42, 14.86, 14.60, &
                         18.14, 16.86, 16.19, 15.47, 14.88, 14.62, &
                         18.77, 17.36, 16.58, 15.72, 15.02, 14.73, &
                         19.70, 18.11, 17.25, 16.27, 15.47, 15.11, &
                         20.67, 18.93, 18.05, 17.01, 16.12, 15.72, &
                         21.58, 19.81, 18.91, 17.82, 16.88, 16.45, &
                         22.53, 20.71, 19.80, 18.69, 17.70, 17.25, &
                         23.50, 21.64, 20.72, 19.58, 18.56, 18.10, &
                         24.41, 22.58, 21.65, 20.49, 19.46, 18.99/

 data h2o_LTE_low_para  /17.72, 16.60, 16.12, 15.43, 14.86, 14.60, &
                         17.76, 16.63, 16.13, 15.43, 14.86, 14.60, &
                         18.07, 16.85, 16.24, 15.48, 14.88, 14.62, &
                         18.83, 17.41, 16.61, 15.72, 15.03, 14.73, &
                         19.68, 18.11, 17.26, 16.28, 15.47, 15.11, &
                         20.50, 18.94, 18.06, 17.01, 16.12, 15.72, &
                         21.37, 19.83, 18.93, 17.82, 16.87, 16.45, &
                         22.28, 20.75, 19.81, 18.69, 17.70, 17.25, &
                         23.22, 21.69, 20.73, 19.58, 18.56, 18.10, &
                         24.19, 22.60, 21.65, 20.49, 19.45, 18.99/

 data h2o_LTE_high / 13.85, 13.16, 12.32, 11.86, 11.64, &
                     13.86, 13.16, 12.32, 11.86, 11.64, &
                     13.86, 13.16, 12.32, 11.86, 11.64, &
                     13.88, 13.17, 12.32, 11.86, 11.64, &
                     14.05, 13.25, 12.34, 11.87, 11.65, &
                     14.46, 13.53, 12.49, 11.97, 11.72, &
                     15.05, 14.02, 12.87, 12.35, 12.06, &
                     15.74, 14.63, 13.46, 12.97, 12.66, &
                     16.50, 15.32, 14.16, 13.69, 13.36, &
                     17.31, 16.07, 14.94, 14.46, 14.13/

 data h2o_n05_low_ortho /8.81, 8.90, 9.03, 9.14, 9.19, 9.20, &
                         8.79, 8.88, 9.01, 9.13, 9.20, 9.20, &
                         8.60, 8.73, 8.88, 9.03, 9.13, 9.15, &
                         7.96, 8.14, 8.31, 8.55, 8.78, 8.85, &
                         7.01, 7.21, 7.40, 7.69, 8.00, 8.11, &
                         6.02, 6.20, 6.41, 6.71, 7.04, 7.17, &
                         5.03, 5.21, 5.42, 5.70, 6.06, 6.19, &
                         4.02, 4.21, 4.41, 4.71, 5.05, 5.19, &
                         3.02, 3.22, 3.41, 3.71, 4.06, 4.20, &
                         2.03, 2.21, 2.42, 2.70, 3.06, 3.20/

 data h2o_n05_low_para /9.30, 9.11, 8.94, 8.70, 8.55, 8.50, &
                        9.25, 9.06, 8.91, 8.69, 8.54, 8.49, &
                        8.94, 8.82, 8.71, 8.56, 8.46, 8.43, &
                        8.17, 8.16, 8.16, 8.12, 8.10, 8.11, &
                        7.21, 7.24, 7.28, 7.30, 7.32, 7.35, &
                        6.20, 6.24, 6.31, 6.33, 6.35, 6.38, &
                        5.21, 5.25, 5.30, 5.32, 5.35, 5.39, &
                        4.22, 4.26, 4.31, 4.33, 4.36, 4.40, &
                        3.23, 3.24, 3.31, 3.33, 3.37, 3.41, &
                        2.21, 2.25, 2.30, 2.32, 2.37, 2.41/

 data h2o_n05_high / 9.04, 9.19, 9.50, 9.67, 9.60, &
                     9.04, 9.19, 9.50, 9.67, 9.60, &
                     9.03, 9.19, 9.50, 9.66, 9.59, &
                     8.89, 9.11, 9.47, 9.65, 9.59, &
                     8.37, 8.73, 9.31, 9.56, 9.53, &
                     7.51, 7.95, 8.74, 9.15, 9.20, &
                     6.53, 6.99, 7.87, 8.38, 8.50, &
                     5.57, 6.03, 6.94, 7.48, 7.64, &
                     4.59, 5.09, 6.02, 6.59, 6.78, &
                     3.58, 4.10, 5.08, 5.69, 5.89/

 data h2o_alp_low_ortho / 0.71, 0.49, 0.48, 0.46, 0.45, 0.45, &
                          0.64, 0.49, 0.48, 0.45, 0.45, 0.45, &
                          0.57, 0.50, 0.47, 0.45, 0.44, 0.44, &
                          0.56, 0.53, 0.48, 0.44, 0.42, 0.41, &
                          0.59, 0.60, 0.53, 0.47, 0.45, 0.43, &
                          0.72, 0.64, 0.58, 0.52, 0.49, 0.47, &
                          0.85, 0.68, 0.61, 0.56, 0.52, 0.50, &
                          0.86, 0.70, 0.63, 0.58, 0.55, 0.53, &
                          0.93, 0.72, 0.66, 0.61, 0.57, 0.55, &
                          0.87, 0.73, 0.67, 0.62, 0.59, 0.56/
                          
 data h2o_alp_low_para  / 0.49, 0.72, 0.69, 0.53, 0.46, 0.44, &
                          0.52, 0.65, 0.66, 0.53, 0.46, 0.44, & 
                          0.49, 0.65, 0.63, 0.51, 0.45, 0.43, &
                          0.57, 0.73, 0.65, 0.49, 0.43, 0.41, &
                          0.75, 0.68, 0.64, 0.52, 0.45, 0.42, &
                          0.76, 0.70, 0.68, 0.55, 0.47, 0.43, &
                          0.79, 0.73, 0.69, 0.58, 0.48, 0.44, &
                          0.80, 0.75, 0.71, 0.58, 0.50, 0.46, &
                          0.82, 0.77, 0.73, 0.60, 0.52, 0.48, &
                          0.91, 0.80, 0.74, 0.62, 0.53, 0.50/ 

 data h2o_alp_high      / 0.42, 0.39, 0.36, 0.34, 0.34, &
                          0.42, 0.39, 0.36, 0.34, 0.34, &
                          0.41, 0.39, 0.36, 0.34, 0.34, &
                          0.39, 0.37, 0.35, 0.33, 0.33, &
                          0.38, 0.34, 0.33, 0.32, 0.32, &
                          0.38, 0.34, 0.32, 0.30, 0.30, &
                          0.40, 0.35, 0.32, 0.29, 0.30, &
                          0.42, 0.36, 0.32, 0.28, 0.29, &
                          0.44, 0.37, 0.31, 0.27, 0.28, &
                          0.45, 0.39, 0.31, 0.27, 0.27/

! CO vibrational cooling

 data co_vib_temp /100., 200., 400., 1000., 2000., 4000./

 data co_vib_column /13.0, 14.0, 15.0, 16.0, 17.0, 18.0,  &
                     19.0, 20.0/

 data co_vib_LTE /10.83, 10.82, 10.82, 10.80, 10.77, 10.79, &
                  10.84, 10.83, 10.82, 10.80, 10.77, 10.79, &
                  10.88, 10.86, 10.84, 10.81, 10.77, 10.80, &
                  11.20, 11.11, 11.03, 10.92, 10.82, 10.82, &
                  11.99, 11.86, 11.73, 11.42, 11.17, 11.04, &
                  12.89, 12.77, 12.61, 12.18, 11.95, 11.75, &
                  13.82, 13.70, 13.44, 13.03, 12.63, 12.31, &
                  14.76, 14.65, 14.30, 13.93, 13.46, 13.09/

! H2O vibrational cooling

 data h2o_vib_temp /100., 200., 400., 1000., 2000., 4000./

 data h2o_vib_column /13.0, 14.0, 15.0, 16.0, 17.0, 18.0,  &
                      19.0, 20.0/

 data h2o_vib_LTE /10.98, 11.05, 11.07, 10.88, 10.67, 10.67, &
                   10.99, 11.05, 11.07, 10.88, 10.67, 10.67, &
                   11.06, 11.09, 11.09, 10.88, 10.67, 10.67, &
                   11.36, 11.31, 11.23, 10.93, 10.69, 10.68, &
                   11.91, 11.82, 11.65, 11.15, 10.79, 10.72, &
                   12.59, 12.50, 12.28, 11.61, 11.11, 10.90, &
                   13.29, 13.20, 12.99, 12.25, 11.65, 11.30, &
                   13.90, 13.90, 13.76, 13.01, 12.34, 11.88/


end module mol_data
